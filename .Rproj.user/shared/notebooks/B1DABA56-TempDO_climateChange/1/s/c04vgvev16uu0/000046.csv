"0","# fit a linear regression for anomaly values vs. year by month-station using the mblm function (median based linear model) as this is thought to be less sensitive to outliers."
"0",""
"0","# install.packages(""mblm"")"
"0","library(mblm)"
"0",""
"0","#Usage"
"0","#mblm(formula, dataframe, repeated = TRUE)"
"0","  #Arguments"
"0","    #formula A formula of type y ~ x (only linear models are accepted)"
"0","    #dataframe Optional dataframe"
"0","    #repeated If set to true, model is computed using repeated medians. If false, a single median estimators are calculated"
"0",""
"0","subset.df$Year <- year(subset.df$Date)"
"0",""
"0","# remove NA values -- mblm() does not handle NA as lm() does"
"0","subset.df <- subset.df %>%"
"0","  filter(!is.na(TAnomaly))"
"0",""
"0","# create list to store regression results"
"0","modelSummaries <- list()"
"0",""
"0","for (station_id in unique(subset.df$FDT_STA_ID)) {"
"0","  for (month_num in 5:10) {"
"0","    "
"0","    month_station <- subset.df %>%"
"0","      filter(FDT_STA_ID == station_id & MonthNum == month_num)"
"0",""
"0","      model <- mblm(TAnomaly ~ Year, data = month_station)"
"0","      mod.sum <- summary.mblm(model)"
"0","      "
"0","      # store results"
"0","      modelSummaries[[paste(station_id, month_num, sep = ""_"")]] <- list("
"0","        slope = mod.sum$coefficients[2,1],"
"0","        MAD = mod.sum$coefficients[""Year"", ""MAD""] ,"
"0","        pvalue = mod.sum$coefficients[""Year"", 4]"
"0","        )"
"0","  }"
"0","}"
"0",""
"0","# mblm does not return a standard error. Instead, summary.mblm can be used to extract the MAD or Median Absolute Deviation."" It's a robust measure of variability that is less sensitive to outliers than the standard deviation, which is commonly used in traditional statistical analyses. "
"0",""
